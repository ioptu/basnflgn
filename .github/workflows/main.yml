name: baslgn 

on:
  # 1. æ¯æ—¥å®šæ—¶è¿è¡Œ (ä½¿ç”¨ CRON è¡¨è¾¾å¼å®šä¹‰è¿è¡Œæ—¶é—´ï¼Œæ­¤å¤„ç¤ºä¾‹ä¸ºæ¯å¤© UTC æ—¶é—´ 02:00 è¿è¡Œ)
  #schedule:
    # æ¨èæ ¹æ®æ‚¨çš„ BAS å·¥ä½œåŒºæ‰€åœ¨åœ°æ—¶åŒºè°ƒæ•´æ­¤æ—¶é—´
    #- cron: '0 2 * * *'
  
  # 2. å…è®¸åœ¨ GitHub UI ä¸Šæ‰‹åŠ¨è§¦å‘æ­¤å·¥ä½œæµ
  workflow_dispatch:
    
jobs:
  run_bas_startup:
    runs-on: ubuntu-latest
    timeout-minutes: 15
    env:
      PUPPETEER_SKIP_CHROMIUM_DOWNLOAD: true
      PUPPETEER_EXECUTABLE_PATH: /usr/bin/google-chrome
    steps:
      - name: â¬‡ï¸ æ£€å‡ºä»£ç  
        uses: actions/checkout@v4
      - name: ğŸ› ï¸ è®¾ç½® Node.js ç¯å¢ƒ 
        uses: actions/setup-node@v4
        with:
          node-version: '20'
      - name: âš™ï¸ å®‰è£… Puppeteer ä¾èµ–
        run: npm install
      - name: ğŸ’» è¿è¡Œ BAS å¯åŠ¨è„šæœ¬ 
        run: node ka.js
        env:
          BAS_URL: ${{ secrets.BAS_URL }}
          BAS_USERNAME: ${{ secrets.BAS_USERNAME }}
          BAS_PASSWORD: ${{ secrets.BAS_PASSWORD }}
          
      - name: ğŸ“‚ æ£€æŸ¥æˆªå›¾æ–‡ä»¶æ˜¯å¦å­˜åœ¨
        run: ls -l status_screenshot/latest_bas_status.png
      - name: ğŸ“¤ ä¸Šä¼ æˆªå›¾ä½œä¸º Artifacts
        uses: actions/upload-artifact@v4
        with:
          name: bas-status-screenshot
          path: status_screenshot/latest_bas_status.png
          retention-days: 7 
      - name: âœ… å·¥ä½œæµå®Œæˆ
        run: echo "BAS è‡ªåŠ¨åŒ–åˆå§‹åŒ–æµç¨‹å®Œæˆï¼Œæˆªå›¾å·²ä¸Šä¼ åˆ° Artifactsï¼Œå¹¶ä¿ç•™ 7 å¤©ã€‚"
